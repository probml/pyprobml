An error occurred while executing the following cell:
------------------
# Based on
# https://github.com/tensorflow/docs/blob/master/site/en/r1/tutorials/keras/basic_classification.ipynb
# (MIT License)


from __future__ import absolute_import, division, print_function


try:
    from tensorflow import keras
except ModuleNotFoundError:
    %pip install -qq tensorflow
    from tensorflow import keras
import tensorflow as tf
import numpy as np
import matplotlib.pyplot as plt
import os

figdir = "figures"


def savefig(fname):
    plt.savefig(os.path.join(figdir, fname))


np.random.seed(0)


data = keras.datasets.cifar10

(train_images, train_labels), (test_images, test_labels) = data.load_data()

# print(np.shape(train_images))
# print(np.shape(test_images))


# For CIFAR:
# (50000, 32, 32, 3)
# (10000, 32, 32, 3)

class_names = ["plane", "car", "bird", "cat", "deer", "dog", "frog", "horse", "ship", "truck"]

plt.figure(figsize=(10, 10))
for i in range(25):
    plt.subplot(5, 5, i + 1)
    plt.xticks([])
    plt.yticks([])
    plt.grid(False)
    plt.imshow(train_images[i])
    y = train_labels[i][0]
    plt.xlabel(class_names[y])
savefig("cifar10-data.pdf")
plt.show()
------------------

---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipykernel_4584/2473630569.py in <module>
      9 try:
---> 10     from tensorflow import keras
     11 except ModuleNotFoundError:

~/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/__init__.py in <module>
     36 
---> 37 from tensorflow.python.tools import module_util as _module_util
     38 from tensorflow.python.util.lazy_loader import LazyLoader as _LazyLoader

ModuleNotFoundError: No module named 'tensorflow.python'

During handling of the above exception, another exception occurred:

ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipykernel_4584/2473630569.py in <module>
     11 except ModuleNotFoundError:
     12     get_ipython().run_line_magic('pip', 'install -qq tensorflow')
---> 13     from tensorflow import keras
     14 import tensorflow as tf
     15 import numpy as np

~/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/__init__.py in <module>
     35 import typing as _typing
     36 
---> 37 from tensorflow.python.tools import module_util as _module_util
     38 from tensorflow.python.util.lazy_loader import LazyLoader as _LazyLoader
     39 

ModuleNotFoundError: No module named 'tensorflow.python.tools'
ModuleNotFoundError: No module named 'tensorflow.python.tools'
