An error occurred while executing the following cell:
------------------
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize, line_search


import jax
import jax.numpy as jnp
from jax import random, vmap, jit, grad, value_and_grad, hessian, jacfwd, jacrev

# Objective is a quadratic
# f(x) = 0.5 x'Ax + b'x + c


def gradient_descent(x0, f, f_prime, hessian, stepsize=None, nsteps=50):
    """
    Steepest-Descent algorithm with option for line search
    """
    x_i, y_i = x0
    all_x_i = list()
    all_y_i = list()
    all_f_i = list()

    for i in range(1, nsteps):
        all_x_i.append(x_i)
        all_y_i.append(y_i)
        x = np.array([x_i, y_i])
        all_f_i.append(f(x))
        dx_i, dy_i = f_prime(x)
        if stepsize is None:
            # Compute a step size using a line_search to satisfy the Wolf
            # conditions
            step = line_search(f, f_prime, np.r_[x_i, y_i], -np.r_[dx_i, dy_i], np.r_[dx_i, dy_i], c2=0.05)
            step = step[0]
            if step is None:
                step = 0
        else:
            step = stepsize
        x_i += -step * dx_i
        y_i += -step * dy_i
        if np.abs(all_f_i[-1]) < 1e-5:
            break
    return all_x_i, all_y_i, all_f_i


def make_plot(A, b, c, fname):
    def objective(x):  # x is (2,)
        f = jnp.dot(x, jnp.dot(A, x)) + jnp.dot(x, b) + c
        return f

    def objective_vectorized(X):  # x is (N,2)
        f = vmap(objective)(X)
        return f

    def gradient(x):
        return jnp.dot(A + A.T, x) + b

    def hessian(x):
        return A

    z = objective_vectorized(X)
    N = len(x1)
    z = np.reshape(z, (N, N))
    plt.contour(x1, x2, z, 50)
    x0 = np.array((0.0, 0.0))
    # x0 = np.array((-1.0, -1.0))
    xs, ys, fs = gradient_descent(x0, objective, gradient, hessian, stepsize=None)
    nsteps = 20
    plt.scatter(xs[:nsteps], ys[:nsteps])
    plt.plot(xs[:nsteps], ys[:nsteps])
    plt.title("condition number of A={:0.3f}".format(np.linalg.cond(A)))
    plt.tight_layout()
    plt.savefig("figures/{}.pdf".format(fname), dpi=300)
    plt.show()


x1 = np.arange(-2, 2, 0.1)  # xs is (40,)
x2 = x1
xs, ys = np.meshgrid(x1, x2)  # xs is (1600,)
X = np.stack((xs.flatten(), ys.flatten()), axis=1)  # (1600,2)

A = np.array([[20, 5], [5, 2]])
b = np.array([-14, -6])
c = 10
fname = "steepestDescentCondNumBig"
make_plot(A, b, c, fname)

A = np.array([[20, 5], [5, 16]])
fname = "steepestDescentCondNumSmall"
make_plot(A, b, c, fname)
------------------

---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
/tmp/ipykernel_5080/947447400.py in <module>
      4 
      5 
----> 6 import jax
      7 import jax.numpy as jnp
      8 from jax import random, vmap, jit, grad, value_and_grad, hessian, jacfwd, jacrev

~/miniconda3/envs/py37/lib/python3.7/site-packages/jax/__init__.py in <module>
     33 # We want the exported object to be the class, so we first import the module
     34 # to make sure a later import doesn't overwrite the class.
---> 35 from jax import config as _config_module
     36 del _config_module
     37 

~/miniconda3/envs/py37/lib/python3.7/site-packages/jax/config.py in <module>
     15 # TODO(phawkins): fix users of this alias and delete this file.
     16 
---> 17 from jax._src.config import config

~/miniconda3/envs/py37/lib/python3.7/site-packages/jax/_src/config.py in <module>
     27 from absl import logging
     28 
---> 29 from jax._src import lib
     30 from jax._src.lib import jax_jit
     31 from jax._src.lib import transfer_guard_lib

~/miniconda3/envs/py37/lib/python3.7/site-packages/jax/_src/lib/__init__.py in <module>
     95   jax_version=jax.version.__version__,
     96   jaxlib_version=jaxlib.version.__version__,
---> 97   minimum_jaxlib_version=jax.version._minimum_jaxlib_version)
     98 
     99 

~/miniconda3/envs/py37/lib/python3.7/site-packages/jax/_src/lib/__init__.py in check_jaxlib_version(jax_version, jaxlib_version, minimum_jaxlib_version)
     87            f'incompatible with jax version {jax_version}. Please '
     88            'update your jax and/or jaxlib packages.')
---> 89     raise RuntimeError(msg)
     90 
     91   return _jaxlib_version

RuntimeError: jaxlib version 0.3.15 is newer than and incompatible with jax version 0.3.14. Please update your jax and/or jaxlib packages.
RuntimeError: jaxlib version 0.3.15 is newer than and incompatible with jax version 0.3.14. Please update your jax and/or jaxlib packages.
